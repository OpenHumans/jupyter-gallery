{% extends 'main/base.html' %}
{% load static %}
{% block content %}

  <div class="container">
    <div class="row">
      <div class="col-xs-12">
        <p>
          <b>Want to explore your data in Open Humans?
          This gallery will help.</b>
          There are a bunch of notebooks that you can use.
          See if you find one you'd like to try – please give it
          a ♥ if you like it!
        </p>
        <hr>
        {% include 'main/partials/notebooks-table.html' %}
        <hr>
        <p class="small">
          Want to add a notebook to the gallery?
        {% if client_id %}
        <a href="https://www.openhumans.org/direct-sharing/projects/oauth2/authorize/?client_id={{ client_id }}&response_type=code&redirect_uri={{ redirect_uri }}">
          Click here to log in
        </a>
        {% else %}
        <p class="text-muted"><i>
          The log in link is unavailable because client_id hasn't been configured.
        </i></p>
        {% endif %}
      </div> <!-- /.col-xs-12 -->
    </div> <!-- /.row -->
</div>
{% endblock %}

{% block extra_js %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>

<script>
  var options = {
    valueNames: [ 'name', 'source', 'date' ]
  };

  {% for source in data_sources %}

  $('.filter-{{ source|cut:" " }}').on('click',function(){
    var $text = $(this).text();
    if($(this).hasClass( 'selected' )){
      notebookList.filter();
      $(this).removeClass('selected');
    } else {
      notebookList.filter(function(item) {
        console.log(item.values().source)
        console.log($text)
        return (item.values().source.includes($text));
      });
      $(this).addClass('selected');
    }
  });
  {% endfor %}

  var notebookList = new List('notebooks', options);
</script>
{% endblock %}
